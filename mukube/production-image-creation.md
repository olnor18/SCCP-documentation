# Production image creation

At the time of writing (2021-12-07) a production image can be built by using mukube's [kas-base](https://github.com/distributed-technologies/mukube/blob/feature/yocto-switch/kas-base.yaml) config with [distributed-technologies/mukube#55](https://github.com/distributed-technologies/mukube/pull/55) on top.

The built image needs a config partition generated by the [mukube-configurator](https://github.com/distributed-technologies/mukube-configurator) tool, which can be added to the built image with these commands:

```sh
image="mukube-image-mukube-20211126074115.rootfs.wic"
sgdisk -n 0:0:+100MB -t 8300 "$image"
loop="$(sudo losetup --partscan --find --show "$image")"
path="$(lsblk -n -o PATH "$loop" | tail -n1)"
sudo dd if=dev-master0.ext4 of="$path" status=progress
sudo losetup -d "$loop"
```
